# Пакет: data.local.dao

Пакет містить інтерфейси **Data Access Objects (DAO)**, які є посередниками між кодом додатка та базою даних SQLite. Вони надають методи для виконання SQL-запитів без необхідності ручного написання коду взаємодії з курсорами.

## Компоненти доступу

### 1. ChatDao
Відповідає за маніпуляцію даними про чати.
* **getAllChats()**: Повертає реактивний потік `Flow<List<ChatEntity>>`. Будь-які зміни в базі даних автоматично ініціюють оновлення в інтерфейсі користувача через механізми реактивного програмування.
* **insertChat/insertChats**: Використовує стратегію заміни (`REPLACE`) при конфліктах, що дозволяє оновлювати існуючі локальні записи новими даними з сервера Firebase.
* **updateLastMessage()**: Спеціалізований метод для атомарного оновлення стану останнього повідомлення, що підвищує загальну продуктивність системи.

### 2. MessageDao
Відповідає за роботу з повідомленнями.
* **getMessagesForChat(chatId)**: Формує запит на отримання історії повідомлень для конкретного діалогу. Повертає `Flow`, що забезпечує оновлення екрана чату в реальному часі при надходженні нових пакетів даних.
* **deleteMessagesByChatId()**: Забезпечує видалення історії при видаленні чату, що є важливою частиною реалізації конфіденційності користувача.



## Технічні особливості
1. **Асинхронність**: Більшість методів є `suspend` функціями, що гарантує їх виконання у фоновому потоці через Kotlin Coroutines, не блокуючи головний потік інтерфейсу.
2. **Реактивність**: Використання `Flow` дозволяє реалізувати декларативний підхід до побудови UI за допомогою фреймворку Jetpack Compose.
3. **Цілісність**: Операції виконуються в межах транзакцій SQLite, що гарантує збереження структури бази навіть при раптових збоях додатка.